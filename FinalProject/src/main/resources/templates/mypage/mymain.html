<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultarag.net.nz/thymeleaf/layout"
	layout:decorate="layouts/second_layout"
	xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<th:block layout:fragment="content">
	<div class="col-md-10 ps-5 pt-5" id="main-con">
		<div class="d-flex align-items-center justify-content-center mb-5"
			id="my-text1">My Page</div>
		<div id="profile">
			<img src="/img/cake.jpg" class="img-pluid" id="profile_img">
			<div id="loginid" th:inline="text">[[${name}]]님 
			안녕하세요 이곳은 마이페이지입니다.</div>
		</div>
		<div id="content_title">
			<h2>주문조회</h2>
		</div>
		<hr />
		<div id="content" align="center">
			<table class="table table-striped table-bordered fs-5">
				<thead>
					<tr>
						<th scope="col">상품명</th>
						<th scope="col">예약일자</th>
						<th scope="col">가격</th>
						<th scope="col">후기작성</th>
					</tr>
				</thead>
				<tbody>
					<tr th:if="${#lists.isEmpty(reslist)}">
					<td colspan="4">
						아직 예약 결제한 내역이 없습니다.
					</td>
					</tr>
					<tr th:each="list : ${reslist}" th:unless="${#lists.isEmpty(reslist)}">
						<td th:text="${list.room.name}"></td>
						<td th:inline="text">[[${#dates.format(list.start_time,'yyyy-MM-dd HH시 00분')}]]</td>
						<td th:inline="text">[[${#numbers.formatInteger(list.totalprice,3,'COMMA')}]]원</td>
						<td th:if="${list.start_time.before(#dates.createNow())}"><a th:href="@{/review/write(resid=${list.id})}">작성하기</a></td>
						<td th:unless="${list.start_time.before(#dates.createNow())}" th:with="days=${T(java.util.concurrent.TimeUnit).DAYS}, millis=${T(java.util.concurrent.TimeUnit).MILLISECONDS}">
						<a th:unless="${#numbers.formatInteger(days.convert(#dates.createNow().getTime() - list.start_time.getTime(), millis),1)} > -3" th:href="@{/kakao/refund(resid=${list.id})}">환불</a>
						<a th:if="${#numbers.formatInteger(days.convert(#dates.createNow().getTime() - list.start_time.getTime(), millis),1)} > -3" >환불불가</a>
						</td>
					</tr>
				</tbody>
			</table>
		</div>
	</div>
	</div>
	</div>
	</div>
	<script th:inline="javascript">
	</script>
</th:block>
</html>
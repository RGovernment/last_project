<!doctype html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultarag.net.nz/thymeleaf/layout"
	layout:decorate="layouts/first_layout"
	xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
	
<th:block layout:fragment="content">
	<h1> kakaoPay api 이용하기</h1>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script type="text/javascript" src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="https://service.iamport.kr/js/iamport.payment-1.1.5.js"></script>
<script type="text/javascript" th:inline="javascript">
$(function(){
	$('.button').click(function(){
		var token = $("meta[name='_csrf']").attr("content");
		var header = $("meta[name='_csrf_header']").attr("content");
		var device = $("#device").data("device");
		let id ="";
		$.ajax({
			
			url:'kakao/kakaotest',
			dataType:'json',
			beforeSend: function(xhr) {  
				xhr.setRequestHeader(header, token);
			},
			success:function(data){
				if (/Mobi|Android/i.test(navigator.userAgent)) {
					
					window.open(data.next_redirect_mobile_url, "모바일");
				}else{
				window.open(data.next_redirect_pc_url, "PC");
				}
				
			},
			error:function(error){
				alert(error);
			}
		});
		
	});
});
</script>
	<button class="button"> 카카오페이로 결제하기</button>
	<script
		src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js"
		integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3"
		crossorigin="anonymous"></script>
</th:block>
</html>